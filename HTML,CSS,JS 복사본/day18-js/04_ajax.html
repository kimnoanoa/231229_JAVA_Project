<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h1>
        비동기 통신 (asynchronous communication) : AJAX
    </h1>
    <ul>
        <li>
            동기방식 (synchronous)
            동시에 일어나는 요청을 하면 바로 응답을 받는다는 의미
            순서적임
            <form>동기방식</form>
            요청하면 페이지로 리턴
        </li>
        <li>
            비동기방식(asynchronous)
            동시에 일어나지 않는 요청
            그자리에서 결과가 바로 주어지지 않을수도 있음
            순서적이지 않음
        </li>
        <li>
            동기와 비동기의 장단점
        </li>
        <li>
            동기방식 : 직관적, 설계가 간단함
            결과가 주어지기 전까지는 아무것도 못하고 대기해야 한다는 단점

        </li>
        <li>
            비동기방식 : 설계가 복잡함.
            결과가 주어지는 데까지는 시간이 걸려도 다른 작업을 할 수 있음(효율적)
        </li>
        <li>
            비동기방식 : AJAX jquery (라이브러리)
        </li>
    </ul>
    <ul>
        <li>
            async await : 비동기 통신 키워드
            promise 객체를 이용하여 데이터 통신을 편리하게 할 수 있도록 제공되는 키워드
        </li>
        <li>
            async 키워드 : 함수 선언 앞에 붙이는 키워드(async function)
            그 함수의 리턴타입이 프로미스 객체 타입으로 리턴됨
        </li>
        <li>
            await 키워드 : 순차적으로 코드가 실행되어야 할 때 사용
            순차 코드 실행시 지연로딩, 지연 실행상황이 발생하면
            코드 실행을 순차적으로 할 수 있도록 보증한다.
            즉, 이전 라인의 코드실행이 완료돨때까지 다음라인은 기다릴 수 있도록 하는 기능
        </li>
        <li>
            https://jsonplaceholder.typicode.com/
        </li>
        <li></li>
        <h3>async await 연습</h3>
        <button type="button" id="btn"> 데이터 불러오기</button>
        <ul id="ul"></ul>
        <script>
            document.getElementById('btn').addEventListener('click',()=>{
                asyncFun().then(result => printData(result));
                // then 이 반드시 있어야만 찍을수있음.
            })
            async function asyncFun(){
                try {
                    const resp = await fetch('https://jsonplaceholder.typicode.com/todos/1');
                    const result = await resp.json(); //body 에 실어준 값을 json()형태로 리턴
                    console.log(resp);
                    console.log(typeof resp);
                    console.log(result);
                    console.log(typeof result);
                    return result;
                } catch (error) {
                    console.log(error);
                }finally{
                    console.log('await finish');
                }
            }

            function printData(obj){
                console.log(obj);
                let ul = document.getElementById('ul');

                for(const key in obj){
                    ul.innerHTML += `<li> ${key} : ${obj[key]}</li>`;
                }

            }
        </script>
    </ul>
</body>
</html>