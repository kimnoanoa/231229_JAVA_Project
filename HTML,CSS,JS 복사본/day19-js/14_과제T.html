<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h1>야구게임</h1>
    <ul>
        <li>
            세자리의 숫자는 중복되면 안 됨(각 숫자는 자리수를 갖고 있음)
        </li>
        <li>
            각 자리수와 입력한 숫자가 일치하면 1스트라이크
        </li>
        <li>
            숫자만 포함되어 있으면 1볼
        </li>
        <li>
            숫자가 전혀 없으면 아웃
        </li>
        <li>
            3스트라이크면 게임 종료
        </li>
    </ul>
    <button type="button" id="startBtn">게임 시작</button>
    <h1 id="comMsg"></h2>
    숫자 입력 : <input type="text" name="" id="myNum">
    <button type="button" id="tryBtn">게임 확인</button>
    <ol id="tries"></ol>
    <script>
        const comSet = new Set();
        let comNums =[];
        let count = 0;
        const comMsg = document.getElementById('comMsg');
        const tries = document.getElementById('tries');

        // '123' => 숫자로 인지 / '문자' => 문자로 인지
        console.log(isNaN('rrr')); //숫자가 아닌 게 맞는지 확인

        document.getElementById('startBtn').addEventListener('click',makeGame);
        document.getElementById('tryBtn').addEventListener('click',compareNum);

        function compareNum(){
            if (comSet.size <= 0){
                comMsg.innerText = '게임시작버튼을 먼저 눌러주세요.';
                return;
            }
            count ++;
            let myNumVal = document.getElementById('myNum');

            //유효성 검증
            if (validMyNum(myNumVal.value)){
                console.log('valid 통과~');
                let myNums = myNumVal.value.split("");
                console.log(myNums);

                let strike = 0 , ball = 0;
                // 컴기준 숫자
                for (let i = 0 ;i < comNums.length ; i++){
                    //내기준 숫자
                    for (let j = 0; j <myNums.length ; j++){
                        if (comNums[i] == myNums[j]){
                            if (i ==j){   // 자리도 같다면
                              strike++;
                            }else{
                            ball++;
                            }
                             break;
                    }
                }
            }
            if (strike == 0 && ball == 0){
                tries.innerHTML += `<li> ${myNums}=> OUT!</li>`;
            }else{
                if (strike == 3){
                    tries.innerHTML += `<li> ${myNums}=> 정답입니다 !</li>`;
                }else{
                    tries.innerHTML += `<li> ${myNums}=> ${strike} strike , ${ball} ball </li>`;
                }
            }

            }else{
                console.log('valid 통과실패');
                comMsg = '유효하지 않은 숫자입니다.';

            }
            myNumVal.value ="";
            myNumVal.focus();
        }

        function makeGame(){
            comNums =[];
            comSet.clear();
            //이전 게임 내역을 초기화
            document.getElementById('tries').innerText ='';

            do{
                let rNum = Math.floor(Math.random()*10);
                comSet.add(rNum);

            }while(comSet.size <3);

            console.log(comSet);

            //set 을 배열로 저장
            comSet.forEach((v) =>{
                comNums.push(v);
            });
            console.log(comNums);
            document.getElementById('comMsg').innerText ="컴퓨터가 숫자를 결정하였습니다.";

        }

        // 검증
        // 숫자는 3자리 , 숫자만 가능, 중복값은 안됨
        function validMyNum(myNum){
            if(myNum.length != 3){
                return false; // 검증을 할 때는 안되는 케이스를 false 로 만들기
            }else if (isNaN(myNum)){
                return false;
            }else if (new Set(myNum.split("")).size != 3){
                return false;
            }else{
                return true;
            }
        }

        //  console.log(validMyNum('rrr'));




    </script>
</body>
</html>